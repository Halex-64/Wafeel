<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wafeel</title>
    <link rel="stylesheet" href="../CSS/quiz.css"> 
    <link rel="stylesheet" href="../CSS/listas.css">
    <link rel="stylesheet" href="../CSS/lista_usuario.css">
    <link rel="stylesheet" href="../CSS/Pop-up_criar_lista.css">
    <link rel="stylesheet" href="../CSS/responsividade.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.cdnfonts.com/css/coolvetica-2" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
</head>
<body>
    <!--HEADER-->
    <header class="header_quiz">
        <nav class="barradenavegacao">
            <img class="logo__image" src="../assets/img/logo.png" alt="Logo">
            <ul class="links">
                <li><a href="./quiz.html">Quiz</a></li>
                <li><a href="#">Filmes</a></li>
                <li><a href="#">Séries</a></li>
                <li><a id="selecao_roxo" href="./listas.html">Listas</a></li>
                <li><a href="#"><img class="icon" src="../assets/img/favoritosicon.png" alt="Favoritos"></a></li>
                <li><a href="#"><img class="icon" src="../assets/img/usuarioicon.png" alt="Usuário"></a></li>
            </ul>
        </nav>
    </header>

    <!--HEADER RESPONSIVA-->    
    <header class="header_responsiva">
        <nav class="barradenavegacao_responsiva">
            <a href="/public/index.html"><img class="logo__image" src="../assets/img/logo.png" alt="Logo"></a>
            <ul class="links" id="mobile-menu">
                <li><a href="./quiz.html">QUIZ</a></li>
                <li><a href="./filmes.html">FILMES</a></li>
                <li><a href="./series.html">SÉRIES</a></li>                                             
            </ul>
            <button class="menu-toggle" id="menu-toggle">☰</button>
        </nav>
    </header>

    <!--MENU DROP-DOWN RESPONSIVO-->
    <div class="menu_responsivo">
        <ul class="links" id="mobile-menu">
            <li><a href="./quiz.html">QUIZ</a></li>
            <li><a href="./filmes.html">FILMES</a></li>
            <li><a href="./series.html">SÉRIES</a></li> 
            <li><a href="./listas.html">LISTAS</a></li> 
            <li><a href="./favoritos.html">FAVORITOS</a></li>
            <li><a href="./perfil.html">PERFIL</a></li>                             
        </ul>
    </div>

    <!--BARRA NAVEGAÇÃO ENTRE LISTAS-->
    <div class="nav_listas">
        <div class="barra_listas">
            <li><a href="./listas.html">PRINCIPAIS LISTAS</a></li>
            <div id="linha_vertical"></div>
            <li><a id="selecao_roxo" href="./sua_lista.html">SUAS LISTAS</a></li>
        </div>    
        <div id="linha_horizontal"></div>
    </div>

    <!--BARRA NAVEGAÇÃO ENTRE LISTAS RESPONSIVA-->
    <div class="nav_listas_responsiva_direita">
        <div class="barra_listas">           
            <li><a id="selecao_roxo" href="./lista_usuario.html" class="suas_listas">SUAS LISTAS</a></li>
        </div>        
    </div>
    <div class="nav_listas_responsiva_esquerda">
        <div class="barra_listas">
            <li><a class="principais_listas" href="./listas.html">PRINCIPAIS LISTAS</a></li>
        </div>
    </div>

    <section>
        <div class="botao_criar_lista">
            <button type="button" class="btn" id="botao_criar_lista">Crie uma nova lista</button>
        </div>
        <div class="containers_listas">
            <a id="link_lista_criada" href="">
                <div class="container_filme">                    
                    <div class="poster_filmes"></div>
                    <p id="titulo_lista"></p>                
                </div>
            </a>
        </div>
    </section>

    <div id="fundo_escuro" class="fundo-escuro"></div>
    <div id="pop-up_criar_lista" class="pop-up_criar_lista">
        <div class="criar_lista">
            <div class="input_criar_lista">
                <label for="message" class="form_message_label">NOME</label>
                <input type="text" id="list_name" class="form_input" required>
    
                <label for="movie-search" class="form_message_label">ADICIONAR TÍTULO</label>
                <input type="text" id="movie_search" class="form_input" required>
                <div id="suggestions" class="suggestions-container"></div>              
            </div>
            <div id="selected-movies" class="selected-movies-container"></div>
            <div class="criar_cancelar">
                <button type="criar" id="create_button" disabled><span>CRIAR</span></button>
                <button type="cancelar" id="cancel_button"><span>CANCELAR</span></button>
            </div>
        </div>
    </div>

    <!--FOOTER-->
    <footer>
        <div class="social-icons">
            <a href="#">
                <img src="/public/assets/img/whatsapp_icon.png" id="WhatsApp_icon" alt="WhatsApp">
            </a>
            <a href="#">
                <img src="/public/assets/img/instagram_icon.png" id="Instagram_icon" alt="Instagram">
            </a>
            <a href="#">
                <img src="/public/assets/img/help_icon.png" id="suporte_icon" alt="Suporte">
            </a>
        </div>
    </footer>

    <!--FOOTER RESPONSIVO-->
    <footer class="footer_responsivo">
        <div class="footer_links">        
            <a href="#">Login</a>
            <a href="#">Suporte</a>
            <a href="#">Sobre Nós</a>        
        </div>
        <div class="social-icons">
            <a href="#"><img src="/public/assets/img/whatsapp_icon.png" id="WhatsApp_icon" alt="WhatsApp"></a>
            <a href="#"><img src="/public/assets/img/instagram_icon.png" id="Instagram_icon" alt="Instagram"></a>         
        </div>
        <h3>Seu mundo de histórias, personalizado.</h3>
        <a class="logo_footer_responsivo"><img class="logo__image" src="../assets/img/logo.png" alt="Logo"></a>
        <div class="politica_termos">
            <p class="politica_priv">Política de Privacidade</p>
            <p class="term_cond">Termos e Condições</p>
        </div>    
    </footer>

    <!--JAVASCRIPT HEADER RESPONSIVA-->
    <script>
        const menuToggle = document.getElementById('menu-toggle');
        const menuResponsive = document.querySelector('.menu_responsivo');
        const headerResponsive = document.querySelector('.header_responsiva');
        const toggleCor = document.querySelector('.menu-toggle');
        const logoImage = document.querySelector('.barradenavegacao_responsiva .logo__image');  

        menuToggle.addEventListener('click', () => {
            menuResponsive.classList.toggle('show');  
            headerResponsive.classList.toggle('header-active');  
            toggleCor.classList.toggle('menu-toggle-active');
            logoImage.classList.toggle('logoImage-active');  
        });
    </script>

    <!--JAVASCRIPT DO POP-UP CRIAR LISTA-->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
        const botaoCriarLista = document.getElementById('botao_criar_lista');
        const popupCriarLista = document.getElementById('pop-up_criar_lista');
        const fundoEscuro = document.getElementById('fundo_escuro');
        const botaoCancelar = document.getElementById('cancel_button');
        const createButton = document.getElementById('create_button');
        const listNameInput = document.getElementById('list_name');
        const selectedMoviesContainer = document.getElementById('selected-movies');
        const userListsContainer = document.querySelector('.containers_listas');
        
        // Verificação de elementos necessários
        if (!botaoCriarLista || !popupCriarLista || !botaoCancelar || !fundoEscuro || !createButton || !listNameInput || !userListsContainer) {
            console.error('Alguns elementos necessários não foram encontrados no DOM.');
            return;
        }

        // Função para atualizar as listas do usuário na interface
        function updateUserLists() {
            const lists = JSON.parse(localStorage.getItem('userLists') || '[]');
            userListsContainer.innerHTML = ''; // Limpar o conteúdo atual

            lists.forEach(list => {
                const listCard = document.createElement('a');
                listCard.href = `./lista_dinamica.html?list=${encodeURIComponent(list.name)}&movies=${encodeURIComponent(JSON.stringify(list.movies))}`;
                listCard.innerHTML = `
                    <div class="container_filme">
                        <div class="poster_filmes">
                            <img src="${list.movies[0]?.poster || ''}" alt="${list.name}">
                        </div>
                        <p>${list.name}</p>
                    </div>
                `;
                userListsContainer.appendChild(listCard);
            });
        }

        // Evento para criar a lista e redirecionar
        createButton.addEventListener('click', () => {
            const listName = listNameInput.value.trim(); // Nome da lista
            const selectedMovies = Array.from(selectedMoviesContainer.querySelectorAll('.movie-item')).map(movie => ({
                id: movie.dataset.movieId, // ID do filme
                title: movie.querySelector('.movie-title').textContent, // Título do filme
                poster: movie.querySelector('img').src, // Poster do filme
            }));

            if (listName && selectedMovies.length > 0) {
                // Monta a URL com os parâmetros
                const redirectURL = `./lista_dinamica.html?list=${encodeURIComponent(listName)}&movies=${encodeURIComponent(JSON.stringify(selectedMovies))}`;
                
                // Redireciona para a página lista_dinamica.html
                window.location.href = redirectURL;
            } else {
                // Exibe o alerta e não executa o redirecionamento
                alert('Adicione um nome à lista e selecione pelo menos um filme.');
                return; // Impede qualquer execução adicional
            }
        });

        // Mostrar o pop-up de criação de lista
        botaoCriarLista.addEventListener('click', () => {
            popupCriarLista.classList.add('show');
            fundoEscuro.classList.add('show');
            document.documentElement.style.overflow = 'hidden';
            document.body.style.overflow = 'hidden';
        });

        // Ocultar o pop-up de criação de lista
        botaoCancelar.addEventListener('click', () => {
            popupCriarLista.classList.remove('show');
            fundoEscuro.classList.remove('show');
            document.documentElement.style.overflow = '';
            document.body.style.overflow = '';
        });

        // Atualizar as listas do usuário ao carregar a página
        updateUserLists();
    }); 
    </script>
    <script id="popup_criar_lista" src="./Pop-up_criar_lista.js"></script>        
</body>
</html>
